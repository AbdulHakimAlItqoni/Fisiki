<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Simulasi Proyektil 2D – Revisi UAS</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{margin:0;font-family:Segoe UI,sans-serif;background:linear-gradient(135deg,#667eea,#764ba2);color:white}
header{text-align:center;padding:16px}
.container{display:grid;grid-template-columns:320px 1fr;gap:16px;padding:16px}
.panel{background:rgba(255,255,255,0.15);backdrop-filter:blur(10px);border-radius:16px;padding:16px}
label{display:block;margin-top:10px;font-size:.9rem}
input,select,button{width:100%;padding:8px;margin-top:4px;border:none;border-radius:8px}
button{margin-top:14px;background:linear-gradient(135deg,#ff6a00,#ee0979);color:white;font-weight:bold;cursor:pointer}
canvas{width:100%;background:linear-gradient(#87ceeb,#e0f7fa);border-radius:16px}
.result{font-size:.85rem;line-height:1.5;margin-top:10px}
</style>
</head>
<body>
<header>
<h1>Simulasi Proyektil 2D</h1>
<p>Dengan & Tanpa Hambatan Udara (Drag)</p>
</header>
<div class="container">
<div class="panel">
<label>Mode</label>
<select id="mode"><option value="nodrag">Tanpa Drag</option><option value="drag">Dengan Drag</option></select>
<label>Kecepatan Awal v₀ (m/s)</label><input id="v0" type="number" value="28">
<label>Sudut θ (derajat)</label><input id="angle" type="number" value="45">
<label>Massa (kg)</label><input id="mass" type="number" value="1">
<label>Gravitasi g (m/s²)</label><input id="g" type="number" value="9.8">
<label>Koefisien Drag b</label><input id="b" type="number" step="0.01" value="0.12">
<button onclick="launch()">Lempar Bola</button>
<div class="result" id="result"></div>
</div>
<div class="panel"><canvas id="canvas" width="900" height="480"></canvas></div>
</div>
<script>
const canvas=document.getElementById('canvas'),ctx=canvas.getContext('2d');
const groundY=canvas.height-60,startX=120,startY=groundY;
let throws=[]; // simpan max 2 lemparan
let animId;

function drawScene(){
 ctx.fillStyle='#87ceeb';ctx.fillRect(0,0,canvas.width,groundY);
 ctx.fillStyle='#ffeb3b';ctx.beginPath();ctx.arc(canvas.width-80,80,40,0,Math.PI*2);ctx.fill();
 ctx.fillStyle='#4caf50';ctx.fillRect(0,groundY,canvas.width,canvas.height-groundY);
 // orang (gambar sederhana)
 ctx.fillStyle='#000';ctx.beginPath();ctx.arc(startX,startY-70,12,0,Math.PI*2);ctx.fill();ctx.fillRect(startX-3,startY-55,6,35);
}

function drawTrails(){
 throws.forEach(t=>{
  ctx.strokeStyle=t.color;ctx.lineWidth=2;ctx.beginPath();
  t.trail.forEach((p,i)=>{i?ctx.lineTo(p.x,p.y):ctx.moveTo(p.x,p.y)});
  ctx.stroke();
  // garis jarak
  ctx.setLineDash([5,5]);ctx.strokeStyle='white';
  ctx.beginPath();ctx.moveTo(startX,groundY);ctx.lineTo(t.rangeX,groundY);ctx.stroke();ctx.setLineDash([]);
  ctx.fillStyle='white';ctx.fillText(t.range.toFixed(2)+' m',(startX+t.rangeX)/2,groundY-5);
 });
}

function launch(){
 cancelAnimationFrame(animId);
 if(throws.length===2) throws=[]; // reset di lemparan ke-3
 document.getElementById('result').innerHTML='';

 const v0=+v0Input.value,ang=+angleInput.value*Math.PI/180;
 const m=+massInput.value,g=+gInput.value,b=+bInput.value;
 const mode=document.getElementById('mode').value;
 let vx=v0*Math.cos(ang),vy=v0*Math.sin(ang),x=startX,y=startY;
 const dt=0.01;
 const data={trail:[],color:mode==='drag'?'#ff1744':'#2979ff'};
 throws.push(data);

 let t=0,maxY=y;
 function animate(){
  drawScene();drawTrails();
  let ax=0,ay=-g;
  if(mode==='drag'){ax=-(b/m)*vx;ay=-g-(b/m)*vy}
  vx+=ax*dt;vy+=ay*dt;
  x+=vx*dt*5;y-=vy*dt*5;
  data.trail.push({x,y});maxY=Math.min(maxY,y);t+=dt;
  ctx.beginPath();ctx.arc(x,y,8,0,Math.PI*2);ctx.fillStyle=data.color;ctx.fill();
  if(y<groundY) animId=requestAnimationFrame(animate);
  else finish(t,x,maxY,data);
 }
 animate();
}

function finish(time,x,maxY,data){
 data.time=time;
 data.range=(x-startX);
 data.rangeX=x;
 data.height=(groundY-maxY);
 const res=document.getElementById('result');
 res.innerHTML+=`<b>Lemparan ${throws.length}</b><br>Waktu terbang: ${time.toFixed(2)} s<br>Jangkauan: ${data.range.toFixed(2)} m<br>Tinggi maksimum: ${data.height.toFixed(2)} m<br><br>`;
}

const v0Input=document.getElementById('v0'),angleInput=document.getElementById('angle');
const massInput=document.getElementById('mass'),gInput=document.getElementById('g'),bInput=document.getElementById('b');

drawScene();
</script>
</body>

</html>
